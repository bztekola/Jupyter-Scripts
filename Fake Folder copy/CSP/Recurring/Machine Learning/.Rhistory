} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
fmt
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no')) {
res <- 'percent1'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_pretty_df(. fmt
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no')) {
res <- 'percent1'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_pretty_df(. fmt)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no')) {
res <- 'percent1'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_pretty_df(., fmt)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no')) {
res <- 'percent1'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_pretty_df(., c(fmt))
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no')) {
res <- 'percent1'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_pretty_df(., c('number1')
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no')) {
res <- 'percent1'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_format(., fmt) %>%
jb_pretty_df(.)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no')) {
res <- 'percent1'
} else if (col == 'orders_id') {
res <- 'nothing'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_format(., fmt) %>%
jb_pretty_df(.)
oid <- 2000000
main2 %>%
filter(orders_id == oid) %>%
subset(select = c('orders_id','fraud','yes','no')) %>%
rename(actual_fraud_result = fraud) %>%
jb_format(., c('nothing','nothing','percent1','percent1'))
oid <- 2000000
main2 %>%
filter(orders_id == oid) %>%
subset(select = c('orders_id','fraud','yes','no')) %>%
rename(actual_fraud_result = fraud) %>%
jb_format(., c('nothing','nothing','percent1','percent1')) %>%
jb_pretty_df(.)
oid <- 1909645
main2 %>%
filter(orders_id == oid) %>%
subset(select = c('orders_id','fraud','yes','no')) %>%
rename(actual_fraud_result = fraud) %>%
jb_format(., c('nothing','nothing','percent1','percent1')) %>%
jb_pretty_df(.)
oid <- 2000000
main2 %>%
filter(orders_id == oid) %>%
subset(select = c('orders_id','fraud','yes','no')) %>%
rename(actual_fraud_result = fraud) %>%
jb_format(., c('nothing','nothing','percent1','percent1')) %>%
jb_pretty_df(.)
for_cm <- function(df) {
if (df['fraud'] == 'yes' & df['class'] == 'yes') {
return('true positive')
} else if (df['fraud'] == 'yes' & df['class'] == 'no') {
return('false negative')
} else if (df['fraud'] == 'no' & df['class'] == 'no') {
return('true negative')
} else if (df['fraud'] == 'no' & df['class'] == 'yes') {
return('false positive')
} else {
return('something else')
}
}
main2$cm_result <- apply(main2, 1, for_cm)
main2 %>%
group_by(cm_result) %>%
summarise(subtotal = sum(subtotal)) %>%
jb_format(., c('nothing','money')) %>%
jb_pretty_df(.)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no','email_domain_fraud_rating')) {
res <- 'percent1'
} else if (col == 'orders_id') {
res <- 'nothing'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_format(., fmt) %>%
jb_pretty_df(.)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no','email_domain_fraud_rating')) {
res <- 'percent1'
} else if (col == 'orders_id') {
res <- 'nothing'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
rename(predicted_class = class)
jb_format(., fmt) %>%
jb_pretty_df(.)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no','email_domain_fraud_rating')) {
res <- 'percent1'
} else if (col == 'orders_id') {
res <- 'nothing'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
rename(predicted_class = class) %>%
jb_format(., fmt) %>%
jb_pretty_df(.)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no','email_domain_fraud_rating')) {
res <- 'percent1'
} else if (col == 'orders_id') {
res <- 'nothing'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
rename(predicted_class = class, actual_fraud_result = fraud) %>%
jb_format(., fmt) %>%
jb_pretty_df(.)
head(main2)
main2 <- main2 %>%
rename(predicted_class = class, actual_fraud_result = fraud)
for_cm <- function(df) {
if (df['fraud'] == 'yes' & df['class'] == 'yes') {
return('true positive')
} else if (df['fraud'] == 'yes' & df['class'] == 'no') {
return('false negative')
} else if (df['fraud'] == 'no' & df['class'] == 'no') {
return('true negative')
} else if (df['fraud'] == 'no' & df['class'] == 'yes') {
return('false positive')
} else {
return('something else')
}
}
main2$cm_result <- apply(main2, 1, for_cm)
main2 <- merge(main,
pred,
by.x = 0, # merge on rownames
by.y = 0) # merge on rownames
# rename these columns
main2 <- main2 %>%
rename(predicted_class = class, actual_fraud_result = fraud)
# drop this column
main2 <- main2[, names(main2) != 'Row.names']
ggplot(varImp(fit)) +
ggtitle('feature importance chart for best model')
for_cm <- function(df) {
if (df['fraud'] == 'yes' & df['class'] == 'yes') {
return('true positive')
} else if (df['fraud'] == 'yes' & df['class'] == 'no') {
return('false negative')
} else if (df['fraud'] == 'no' & df['class'] == 'no') {
return('true negative')
} else if (df['fraud'] == 'no' & df['class'] == 'yes') {
return('false positive')
} else {
return('something else')
}
}
main2$cm_result <- apply(main2, 1, for_cm)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
for_cm <- function(df) {
if (df['actual_fraud_result'] == 'yes' & df['predicted_class'] == 'yes') {
return('true positive')
} else if (df['actual_fraud_result'] == 'yes' & df['predicted_class'] == 'no') {
return('false negative')
} else if (df['actual_fraud_result'] == 'no' & df['predicted_class'] == 'no') {
return('true negative')
} else if (df['actual_fraud_result'] == 'no' & df['predicted_class'] == 'yes') {
return('false positive')
} else {
return('something else')
}
}
main2$cm_result <- apply(main2, 1, for_cm)
main2 %>%
group_by(cm_result) %>%
summarise(subtotal = sum(subtotal)) %>%
jb_format(., c('nothing','money')) %>%
jb_pretty_df(.)
# get data that has been misclassified
cols <- append(c('orders_id','predicted_class','yes','no'), names(for_model))
mis <- main2 %>%
filter((actual_fraud_result == 'no' & predicted_class == 'yes') | (actual_fraud_result == 'yes' & predicted_class == 'no')) %>%
subset(select = cols)
# get data that has been misclassified
cols <- append(c('orders_id','predicted_class','yes','no'), names(for_model))
mis <- main2 %>%
filter((actual_fraud_result == 'no' & predicted_class == 'yes') | (actual_fraud_result == 'yes' & predicted_class == 'no')) %>%
subset(select = cols)
named(main2)
names(main2)
cols
mis <- main2 %>%
filter((actual_fraud_result == 'no' & predicted_class == 'yes') | (actual_fraud_result == 'yes' & predicted_class == 'no'))
mis <- main2 %>%
filter((actual_fraud_result == 'no' & predicted_class == 'yes') | (actual_fraud_result == 'yes' & predicted_class == 'no')) %>%
subset(select = cols)
# merge the class and class probabilities with the original data
main2 <- merge(main,
pred,
by.x = 0, # merge on rownames
by.y = 0) # merge on rownames
# drop this column
main2 <- main2[, names(main2) != 'Row.names']
for_cm <- function(df) {
if (df['fraud'] == 'yes' & df['class'] == 'yes') {
return('true positive')
} else if (df['fraud'] == 'yes' & df['class'] == 'no') {
return('false negative')
} else if (df['fraud'] == 'no' & df['class'] == 'no') {
return('true negative')
} else if (df['fraud'] == 'no' & df['class'] == 'yes') {
return('false positive')
} else {
return('something else')
}
}
main2$cm_result <- apply(main2, 1, for_cm)
main2 %>%
group_by(cm_result) %>%
summarise(subtotal = sum(subtotal)) %>%
jb_format(., c('nothing','money')) %>%
jb_pretty_df(.)
# get data that has been misclassified
cols <- append(c('orders_id','class','yes','no'), names(for_model))
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no','email_domain_fraud_rating')) {
res <- 'percent1'
} else if (col == 'orders_id') {
res <- 'nothing'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_format(., fmt) %>%
jb_pretty_df(.)
names(for_model)
-names(for_model) %in% fraud
names(for_model) %in% fraud
names(for_model) %in% 'fraud'
names(for_model)[names(for_model) %in% 'fraud']
names(for_model)[-names(for_model) %in% 'fraud']
names(for_model)[~names(for_model) %in% 'fraud']
names(for_model)[names(for_model) %not in% 'fraud']
names(for_model)[names(for_model) %in% 'fraud']
names(for_model)[!names(for_model) %in% 'fraud']
# get data that has been misclassified
cols <- append(c('orders_id','class','fraud','yes','no'), names(for_model)[!names(for_model) %in% 'fraud'])
mis <- main2 %>%
filter((fraud == 'no' & class == 'yes') | (fraud == 'yes' & class == 'no')) %>%
subset(select = cols)
# create formats
fmt <- c()
for (col in names(mis)) {
if (col %in% c('yes','no','email_domain_fraud_rating')) {
res <- 'percent1'
} else if (col == 'orders_id') {
res <- 'nothing'
} else {
if (class(mis[[col]]) == 'character') {
res <- 'nothing'
} else {
res <- 'number1'
}
}
fmt <- append(fmt, res)
}
# view it
head(mis) %>%
jb_format(., fmt) %>%
jb_pretty_df(.)
oid <- 2000000
main2 %>%
filter(orders_id == oid) %>%
subset(select = c('orders_id','fraud','yes','no')) %>%
rename(actual_fraud_result = fraud) %>%
jb_format(., c('nothing','nothing','percent1','percent1')) %>%
jb_pretty_df(.)
oid <- 2000000
main2 %>%
filter(orders_id == oid) %>%
subset(select = c('orders_id','class','fraud','yes','no')) %>%
rename(actual_fraud_result = fraud) %>%
jb_format(., c('nothing','nothing','percent1','percent1')) %>%
jb_pretty_df(.)
oid <- 2000000
main2 %>%
filter(orders_id == oid) %>%
subset(select = c('orders_id','class','fraud','yes','no')) %>%
rename(actual_fraud_result = fraud) %>%
jb_format(., c('nothing','nothing','nothing','percent1','percent1')) %>%
jb_pretty_df(.)
oid <- 2000000
main2 %>%
filter(orders_id == oid) %>%
subset(select = c('orders_id','class','fraud','yes','no')) %>%
rename(actual_fraud_result = fraud, predicted_result = class) %>%
jb_format(., c('nothing','nothing','nothing','percent1','percent1')) %>%
jb_pretty_df(.)
